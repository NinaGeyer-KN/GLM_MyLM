---
title: "solution_1"
output: html_document
date: "2024-09-02"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1: Explanatory analysis of the dataset
### Assumptions: 
- linearity of covariate effects 
- homescedasticity of error variance --> error variacnce same for different dependent variables 
- uncorrelated error 
- additivity of errors 

### Diagnostics plots:

```{r cars, eval = TRUE, echo=FALSE}
#install.packages("car")
library(car)
library(GGally)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]
ggpairs(SLID)
```
### Relations: 
- medium strong (Cohen) , positive correlation between education and wages and age and wages --> good if we want to predict wages, bad if not, because then it shows multicollinearity 
- weak (Cohen), negative correlation between age and education --> again good for prediction of one of them, but bad if not
- there seems to be a small difference in wages between the sexes (males gaining more than females)
- no difference in wages regarding the language level 
- about same distribution of education and age regarding sex 

## Part 2:  Linear regression with the mylm package

### Questions:

What is the interpretation of the parameter estimates?
- a

```{r linear regression, eval = TRUE, echo = FALSE}
#install.packages("car")
#install.packages("mylm")
library(mylm)
library(car)
library(GGally)
library(stringr)
data(SLID, package = "carData")
SLID <- SLID[complete.cases(SLID), ]

# comparison simple model
model1 <- mylm(wages ~ education, data = SLID)
model1b <- lm(wages ~ education, data = SLID)

# print
print.mylm(model1)

# summary 
summary.mylm(model1)
summary(model1b)

```

### Plot 
```{r linear regression plot, eval = TRUE, echo = FALSE}
library(mylm)
model1 <- mylm(wages ~ education, data = SLID)
plot.mylm(model1)
```

### Comments: 
- 

### ANOVA
-What is the residual sum of squares (SSE) and the degrees of freedom for this model?
-What is total sum of squares (SST) for this model? Test the significance of the regression using a 𝜒2-test.
-What is the relationship between the 𝜒2- and 𝑧-statistic in simple linear regression? Find the critical value(s) for both tests.
```{r linear regression anova, eval = FALSE, echo = FALSE}
library(mylm)
library(stringr)
model1 <- mylm(wages ~ education, data = SLID)
anova.mylm(model1)
```

### Comments: 
- 

# Part 3: Multiple Linear Regression 
-What are the estimates and standard errors of the intercepts and regression coefficients for this model? 
-Test the significance of the coefficients using a 𝑧-test.
-What is the interpretation of the parameters?

### Comparison simple linear regression and multiple linear regression 
```{r MLR vs simple linear, eval = FALSE, echo = FALSE}
library(mylm)
model1 <- mylm(wages ~ education, data = SLID)
print(model1)
model1c <- mylm(wages ~ age, data = myframe)
print(model1c)
model2 <- mylm(wages ~ education + age, data = myframe)
print(model2)
```

# Part 4: Testing mylm 
```{r Test mylm 1, eval = FALSE, echo = FALSE}
library(mylm)
model3 <- mylm(wages ~ sex + age + language + I(education^2), data = myframe)
model3b <- mylm(wages ~ sex + age + language + I(education^2), data = myframe)
print(model3)
print(model3b)
```
```{r Test mylm 2, eval = FALSE, echo = FALSE}
library(mylm)
model4 <- mylm(wages ~ language + age + I(language * age), data = myframe)
model4b <- mylm(wages ~ language + age + I(language * age), data = myframe)
print(model4)
print(model4b)
```
```{r Test mylm 3x, eval = FALSE, echo = FALSE}
library(mylm)
model5 <- mylm(wages ~ education - 1, data = myframe)
model5b <- mylm(wages ~ education - 1, data = myframe)
print(model5)
print(model5b)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
